{% extends "base.html.twig" %}

{# Tato sekce naƒç√≠t√° extern√≠ CSS soubor pro styly str√°nky specifick√© pro administraci objedn√°vek #}
{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('css/adminOrders.css') }}">
{% endblock %}

{# Tato sekce naƒç√≠t√° extern√≠ JavaScript soubor pro skripty specifick√© pro administraci objedn√°vek #}
{% block javascripts %}
	<script src="{{ asset('js/adminOrders.js') }}"></script>
{% endblock %}

{% block body %}
	{# Formul√°≈ô pro hled√°n√≠ objedn√°vky podle ID #}
	<div style="text-align: center; margin-bottom: 20px;">
		<form method="get" style="display: inline-block;">
			<input type="text" name="id" placeholder="Hledat objedn√°vku..." value="{{ app.request.get('id') }}">
			<button type="submit">Hledat</button>
		</form>
	</div>

	{# Pokud nejsou ≈æ√°dn√© objedn√°vky, zobraz√≠ se tato zpr√°va #}
	{% if orderSummaries is empty %}
		<h1 class="no-products-message">≈Ω√°dn√© objedn√°vky</h1>
	{% else %}
		{# Pokud existuj√≠ objedn√°vky, zobraz√≠ se seznam objedn√°vek #}
		<div class="orders-container">
			{% for order in orderSummaries %}
				<div
					class="order">
					{# Shrnut√≠ objedn√°vky, kliknut√≠m se zobraz√≠ detaily #}
					<div class="order-summary" onclick="toggleOrderDetails({{ order.id }})">
						<p style="margin: 0 17px 0 0">
							<strong>Objedn√°vka:</strong>
							{{ order.id }}</p>
						<p style="margin: 0 17px 0 0">
							<strong>Datum:</strong>
							{{ order.createdAt|date("d.m.Y H:i") }}</p>
						<p style="margin: 0 17px 0 0">
							<strong>Cena:</strong>
							{{ order.totalPrice }},-</p>
						<p style="margin: 0 17px 0 0">
							<strong>Bez DPH</strong>
							{{ (order.totalPrice / 1.21) |number_format(2, '.', ',') }},-</p>
						<p>
							<strong>Stav objedn√°vky:</strong>
							<span class="status-label {{ order.status }}">{{ order.translatedStatus }}</span>
						</p>
						<a href="{{ path('remove_order', {'id': order.id}) }}">&nbsp;üóë</a>
					</div>

					{# Detaily objedn√°vky, kter√© se zobraz√≠ po kliknut√≠ na shrnut√≠ objedn√°vky #}
					<div class="order-details" id="details-{{ order.id }}">
						<p>
							<strong>Jm√©no:</strong>
							{{ order.userInformation.firstName }}
							{{ order.userInformation.lastName }}</p>
						<p>
							<strong>Email:</strong>
							{{ order.userInformation.mail }}</p>
						<p>
							<strong>Telefon:</strong>
							{{ order.userInformation.phoneNumber }}</p>
						<p>
							<strong>Adresa:</strong>
							{{ order.userInformation.street }}
							{{ order.userInformation.houseNumber }},
							{{ order.userInformation.town }},
							{{ order.userInformation.postcode }}</p>

						<br>
						{# Pokud m√° objedn√°vka informaci o firmƒõ, zobraz√≠ se tyto √∫daje #}
						{% if order.companyInformation %}
							<p>
								<strong>Firma:</strong>
								{{ order.companyInformation.companyName }}</p>
							<p>
								<strong>IƒåO:</strong>
								{{ order.companyInformation.ico }}</p>
							<p>
								<strong>DIƒå:</strong>
								{{ order.companyInformation.dic }}</p>
						{% endif %}
						<br>

						{# Zobrazen√≠ produkt≈Ø v objedn√°vce #}
						<p>
							<strong>Produkty:</strong>
						</p>
						<ul>
							{% for orderSet in order.orderSets %}
								<li>{{ orderSet.product.name }}
									({{ orderSet.quantity }}x)</li>
								<li>{{orderSet.product.price |number_format(2, '.', ',')}},- /ks</li>
								<li>{{(orderSet.product.price / 1.21) |number_format(2, '.', ',')}},- /ks bez DPH</li>
								<br>
							{% endfor %}

							{# Zobrazen√≠ ceny po≈°tovn√©ho a celkov√© ƒç√°stky #}
							<p>+ po≈°tovn√© 79,-</p>
							<p style="font-weight: 600 !important;">{{(order.totalPrice + 79) |number_format(2, '.', ',')}},- celkem</p>
							<p style="font-weight: 600 !important;">{{ ((order.totalPrice + 79) / 1.21) |number_format(2, '.', ',') }},- celkem bez DPH</p>
						</ul>

						{# Tlaƒç√≠tka pro zmƒõnu stavu objedn√°vky #}
						<div class="order-actions">
							<a class="status-btn pending" href="{{ path('set_state_order', {'id': order.id, 'state': 'pending'}) }}">Prob√≠h√°</a>
							<a class="status-btn delivered" href="{{ path('set_state_order', {'id': order.id, 'state': 'delivered'}) }}">Zasl√°no</a>
							<a class="status-btn taken" href="{{ path('set_state_order', {'id': order.id, 'state': 'taken'}) }}">P≈ôevzato</a>
							<a class="status-btn returned" href="{{ path('set_state_order', {'id': order.id, 'state': 'returned'}) }}">Vr√°ceno</a>
						</div>
					</div>
				</div>
			{% endfor %}
		</div>
	{% endif %}

	{# CSS styly pro zaji≈°tƒõn√≠ spr√°vn√©ho zobrazen√≠ str√°nky #}
	<style>
		main {
			display: block;
		}
	</style>

{% endblock %}
